import{c}from"./supabase-DxozfYyO.js";const d="https://bwffvmzxeyhftjtvkpmw.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ3ZmZ2bXp4ZXloZnRqdHZrcG13Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM4MjYyMTUsImV4cCI6MjA3OTQwMjIxNX0.uy-BDEiyaOortHwRXuPBM7RTxrfDmz7g0xQvWIMG_io",o=c(d,l),u={getProjects:async()=>{if(!o)throw new Error("Supabase not configured");const{data:e,error:t}=await o.from("projects").select("*").order("updated_at",{ascending:!1});if(t)throw t;return e.map(r=>({id:r.id,title:r.title,category:r.category,type:r.type,password:r.password,author:r.author,blocks:r.blocks||[],createdAt:r.created_at,updatedAt:r.updated_at}))},saveProject:async e=>{if(!o)throw new Error("Supabase not configured");const t={id:e.id,title:e.title,category:e.category,type:e.type,password:e.password,author:e.author,blocks:e.blocks,updated_at:new Date().toISOString()},{data:r,error:s}=await o.from("projects").upsert(t).select().single();if(s)throw s;return e},deleteProject:async e=>{if(!o)throw new Error("Supabase not configured");const{data:t,error:r}=await o.from("published_contents").select("id").eq("project_id",e);if(r&&console.warn("Failed to fetch published contents for deletion:",r),t&&t.length>0){const i=t.map(n=>n.id),{error:a}=await o.from("published_contents").delete().in("id",i);a&&console.warn("Failed to delete published contents:",a)}const{error:s}=await o.from("projects").delete().eq("id",e);if(s)throw s;return!0},getPublishedContent:async e=>{if(!o)throw new Error("Supabase not configured");const{data:t,error:r}=await o.from("published_contents").select("*").eq("id",e).single();return r?null:{id:t.id,projectId:t.project_id,blocks:t.blocks,metadata:t.metadata,publishedAt:t.published_at}},publishContent:async(e,t)=>{if(!o)throw new Error("Supabase not configured");const r={id:e,project_id:t.projectId,blocks:t.blocks,metadata:t.metadata,published_at:t.publishedAt},{error:s}=await o.from("published_contents").upsert(r);if(s)throw s;return t}},b=u;export{b as s};
