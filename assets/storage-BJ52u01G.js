const n="https://script.google.com/macros/s/AKfycbyTNRpTup97ipSS2ceSjOC9lkekTXMBBxi_QZpPHheZ4Mn_6yVV7fOtmGTHrRZjJHcM/exec",o=async(e,t={})=>{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify({action:e,...t})});if(!s.ok){const r=await s.text();throw new Error(`Google Sheets API Error: ${s.status} - ${r}`)}const a=await s.json();if(a.status==="error")throw new Error(a.message);return a.data},c={getProjects:async()=>(await o("getProjects")).map(t=>({...t,blocks:t.blocks?JSON.parse(t.blocks):[]})),saveProject:async e=>{const t={...e,password:`'${e.password}`,blocks:JSON.stringify(e.blocks)},s=await o("saveProject",{project:t});return{...s,blocks:JSON.parse(s.blocks)}},deleteProject:async e=>(await o("deleteProject",{id:e}),!0),getPublishedContent:async e=>{try{const t=await o("getPublishedContent",{id:e});return t?{...t,blocks:t.blocks?JSON.parse(t.blocks):[],metadata:t.metadata?JSON.parse(t.metadata):{}}:null}catch(t){return console.warn("Faield to get published content",t),null}},publishContent:async(e,t)=>{const s={id:e,projectId:t.projectId,blocks:JSON.stringify(t.blocks),metadata:JSON.stringify(t.metadata),publishedAt:t.publishedAt};return await o("publishContent",{content:s}),t}},l=c;export{l as s};
