const i="https://script.google.com/macros/s/AKfycbyTNRpTup97ipSS2ceSjOC9lkekTXMBBxi_QZpPHheZ4Mn_6yVV7fOtmGTHrRZjJHcM/exec",r=async(e,t={})=>{const s=await fetch(i,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify({action:e,...t})});if(!s.ok){const a=await s.text();throw new Error(`Google Sheets API Error: ${s.status} - ${a}`)}const o=await s.json();if(o.status==="error")throw new Error(o.message);return o.data},n={getProjects:async()=>(await r("getProjects")).map(t=>({...t,blocks:t.blocks?JSON.parse(t.blocks):[]})),saveProject:async e=>{try{(await n.getProjects()).some(c=>c.id===e.id)&&(console.log(`Project ${e.id} exists. Deleting check...`),await n.deleteProject(e.id));const o={...e,password:`'${e.password}`,blocks:JSON.stringify(e.blocks)},a=await r("saveProject",{project:o});return{...a,blocks:JSON.parse(a.blocks)}}catch(t){throw console.error("Failed to save project (Delete-then-Save sequence):",t),t}},deleteProject:async e=>(await r("deleteProject",{id:e}),!0),getPublishedContent:async e=>{try{const t=await r("getPublishedContent",{id:e});return t?{...t,blocks:t.blocks?JSON.parse(t.blocks):[],metadata:t.metadata?JSON.parse(t.metadata):{}}:null}catch(t){return console.warn("Faield to get published content",t),null}},publishContent:async(e,t)=>{const s={id:e,projectId:t.projectId,blocks:JSON.stringify(t.blocks),metadata:JSON.stringify(t.metadata),publishedAt:t.publishedAt};return await r("publishContent",{content:s}),t}},l=n;export{l as s};
