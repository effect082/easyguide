const M=async(t,o={})=>{const{maxWidth:g=1200,maxHeight:i=1200,quality:m=.85}=o;return new Promise((a,r)=>{const n=new FileReader;n.onload=h=>{const s=new Image;s.onload=()=>{let e=s.width,c=s.height;if(e>g||c>i){const l=Math.min(g/e,i/c);e=Math.floor(e*l),c=Math.floor(c*l)}const d=document.createElement("canvas");d.width=e,d.height=c;const w=d.getContext("2d");w.imageSmoothingEnabled=!0,w.imageSmoothingQuality="high",w.drawImage(s,0,0,e,c);const u=d.toDataURL("image/jpeg",m);d.toBlob(l=>{a({dataUrl:u,originalSize:t.size,compressedSize:l.size,reduction:Math.round((1-l.size/t.size)*100),width:e,height:c})},"image/jpeg",m)},s.onerror=()=>r(new Error("Failed to load image")),s.src=h.target.result},n.onerror=()=>r(new Error("Failed to read file")),n.readAsDataURL(t)})},f=t=>{if(t===0)return"0 B";const o=1024,g=["B","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(o));return Math.round(t/Math.pow(o,i)*100)/100+" "+g[i]},p=async(t,o=320,g=.4)=>new Promise((i,m)=>{const a=new Image;a.onload=()=>{let r=a.width,n=a.height;if(r>o){const e=o/r;r=o,n=Math.floor(n*e)}const h=document.createElement("canvas");h.width=r,h.height=n,h.getContext("2d").drawImage(a,0,0,r,n),i(h.toDataURL("image/jpeg",g))},a.onerror=m,a.src=t});export{M as a,p as c,f};
